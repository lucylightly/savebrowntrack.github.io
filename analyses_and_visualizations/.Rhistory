#           color = "white",
#           size = 4.5,
#           nudge_y = 100000,
#           hjust = 0) +
annotate(y = 3000000,
x = "Golf",
geom = "text",
color = "white",
hjust = 0,
vjust = 1,
label = "Data taken from the 2019 \n'Equity in Athletics' report") +
scale_fill_manual(values = c("gray50", "red")) +
scale_y_continuous(limits = c(0, 4500000),
labels = dollar) +
coord_flip() +
ggtitle("Total operating cost for Men's varsity teams",
subtitle = "Based on Brown University's 2019 athletic season") +
theme_minimal() +
theme(axis.text.x = element_text(size = 14,
margin = margin(t = 0.5, unit = "cm"),
color = "white"),
axis.text.y = element_text(size = 14,
color = "white"),
axis.title.y = element_blank(),
axis.title.x = element_text(size = 14,
margin = margin(t = 0.5, unit = "cm"),
color = "white"),
plot.title = element_text(size = 16,
face = "bold"),
plot.subtitle = element_text(size = 13,
face = "italic"),
plot.margin = margin(0.5, 0.5, 0.5, r = 0.75, unit = "cm"),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_line(color = "gray22"),
text = element_text(color = "white",
#face = "bold",
family= "Helvetica"),
plot.background = element_rect(fill = "black"),
legend.position = "none")
## Plot Cost per athlete for each varsity team (Men)
cost_perAthlete.Men %>%
# Reorder Sport by cost per athlete (reorders the labels on the axis)
mutate(`Varsity Sport` = fct_reorder(`Varsity Sport`, `Operating Costs`)) %>%
# Assemble plot
# Assign fill to Track/XC
ggplot(aes(x = `Varsity Sport`, y = `Operating Costs`, fill = is.track)) +
geom_col(color = "black",
width = 0.75) +
# geom_text(aes(label = label_number_si(`Operating Costs`)),
#           color = "white",
#           size = 4.5,
#           nudge_y = 100000,
#           hjust = 0) +
geom_text(aes(label = label_dollar(`Operating Costs`,
# Divide by 1,000 to report in thousands
scale = 1/1000,
# Round to the tenths place
accuracy = .1,
# Add suffix
suffix = "K")),
color = "white",
size = 4.5,
nudge_y = 100000,
hjust = 0) +
annotate(y = 3000000,
x = "Golf",
geom = "text",
color = "white",
hjust = 0,
vjust = 1,
label = "Data taken from the 2019 \n'Equity in Athletics' report") +
scale_fill_manual(values = c("gray50", "red")) +
scale_y_continuous(limits = c(0, 4500000),
labels = dollar) +
coord_flip() +
ggtitle("Total operating cost for Men's varsity teams",
subtitle = "Based on Brown University's 2019 athletic season") +
theme_minimal() +
theme(axis.text.x = element_text(size = 14,
margin = margin(t = 0.5, unit = "cm"),
color = "white"),
axis.text.y = element_text(size = 14,
color = "white"),
axis.title.y = element_blank(),
axis.title.x = element_text(size = 14,
margin = margin(t = 0.5, unit = "cm"),
color = "white"),
plot.title = element_text(size = 16,
face = "bold"),
plot.subtitle = element_text(size = 13,
face = "italic"),
plot.margin = margin(0.5, 0.5, 0.5, r = 0.75, unit = "cm"),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_line(color = "gray22"),
text = element_text(color = "white",
#face = "bold",
family= "Helvetica"),
plot.background = element_rect(fill = "black"),
legend.position = "none")
## Plot Cost per athlete for each varsity team (Men)
cost_perAthlete.Men %>%
# Reorder Sport by cost per athlete (reorders the labels on the axis)
mutate(`Varsity Sport` = fct_reorder(`Varsity Sport`, `Operating Costs`)) %>%
# Assemble plot
# Assign fill to Track/XC
ggplot(aes(x = `Varsity Sport`, y = `Operating Costs`, fill = is.track)) +
geom_col(color = "black",
width = 0.75) +
# geom_text(aes(label = label_number_si(`Operating Costs`)),
#           color = "white",
#           size = 4.5,
#           nudge_y = 100000,
#           hjust = 0) +
geom_text(aes(label = label_dollar(`Operating Costs`,
# Divide by 1,000 to report in thousands
scale = 1/1000,
# Round to the tenths place
accuracy = .1,
# Add suffix
suffix = "K")),
color = "white",
size = 4.5,
nudge_y = 100000,
hjust = 0) +
annotate(y = 3000000,
x = "Golf",
geom = "text",
color = "white",
hjust = 0,
vjust = 1,
label = "Data taken from the 2019 \n'Equity in Athletics' report") +
scale_fill_manual(values = c("gray50", "red")) +
scale_y_continuous(limits = c(0, 4500000),
labels = dollar) +
coord_flip() +
ggtitle("Total operating cost for Men's varsity teams",
subtitle = "Based on Brown University's 2019 athletic season") +
theme_minimal() +
theme(axis.text.x = element_text(size = 14,
margin = margin(t = 0.5, unit = "cm"),
color = "white"),
axis.text.y = element_text(size = 14,
color = "white"),
axis.title.y = element_blank(),
axis.title.x = element_text(size = 14,
margin = margin(t = 0.5, unit = "cm"),
color = "white"),
plot.title = element_text(size = 16,
face = "bold"),
plot.subtitle = element_text(size = 13,
face = "italic"),
plot.margin = margin(0.5, 0.5, 0.5, r = 0.75, unit = "cm"),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_line(color = "gray22"),
text = element_text(color = "white",
#face = "bold",
family= "Helvetica"),
plot.background = element_rect(fill = "black"),
legend.position = "none")
## Clean up
rm(list=ls())
## Set working directory
setwd("~/Desktop/savebrowntrack.github.io/analyses_and_visualizations")
## Key data visualization packages
library(tidyverse)
library(patchwork)
library(scales)
## Operating cost data for Brown U. 2019 Varsity teams
cost_raw <- read_csv("data/data_raw/financial/varsity_operating_costs_2019.csv") %>%
mutate(is.track = if_else(`Varsity Sport` == "Track/XC", "TRUE", "FALSE"))
cost_raw$`Varsity Sport` %>% unique()
## Family costs data for youth sports (1-18)
## Data taken from Aspen Institute/Utah State University 2019 National Youth Sport Survey
youth_sports <- read_csv("data/data_raw/financial/youth_sport_costs.csv") %>%
mutate(is.track = if_else(Sport == "Track and Field" | Sport == "Cross Country", "TRUE", "FALSE"))
## Divide total team operating cost by number of athletes on rost for each row
cost_perAthlete <- cost_raw %>%
mutate(`Cost per Athlete` = `Operating Costs`/Roster)
cost_perAthlete.Men <- cost_perAthlete %>%
filter(Gender == "Men")
cost_perAthlete.Women <- cost_perAthlete %>%
filter(Gender == "Women")
## Calculate cost per roster spot vs cost per athlete
# Explanation: The roster of Brown Men's Track and Field and Cross country is calculated by the
# administration by adding together all registered athletes for Indoor (47), outdoor (44),
# and Cross Country (17). In reality, almost every athlete overlaps between indoor and outdoor
# (except for outdoor exclusive events like javelin). In addition, all cross country runners
# run both indoor and outdoor as well. Thus, the number of unique athletes on the Track, Field,
# and XC roster would be, conservatively, the maximum of any of the three rosters, or 47
# (though others may not have participated due to injury)
cost_perUnique <- cost_perAthlete.Men %>%
filter(`Varsity Sport` == "Track/XC") %>%
mutate(`Varsity Sport` = "Track/XC (per unique athlete)",
Roster = 47,
`Cost per Athlete` = `Operating Costs`/`Roster`)
## Plot Cost per athlete for each varsity team (Men)
cost_perAthlete.Men %>%
# Reorder Sport by cost per athlete (reorders the labels on the axis)
mutate(`Varsity Sport` = fct_reorder(`Varsity Sport`, `Operating Costs`)) %>%
# Assemble plot
# Assign fill to Track/XC
ggplot(aes(x = `Varsity Sport`, y = `Operating Costs`, fill = is.track)) +
geom_col(color = "black",
width = 0.75) +
geom_text(aes(label = label_number_si(`Operating Costs`)),
color = "white",
size = 4.5,
nudge_y = 100000,
hjust = 0) +
# geom_text(aes(label = label_dollar(`Operating Costs`,
#                              # Divide by 1,000 to report in thousands
#                              scale = 1/1000,
#                              # Round to the tenths place
#                              accuracy = .1,
#                              # Add suffix
#                              suffix = "K")),
#           color = "white",
#           size = 4.5,
#           nudge_y = 100000,
#           hjust = 0) +
annotate(y = 3000000,
x = "Golf",
geom = "text",
color = "white",
hjust = 0,
vjust = 1,
label = "Data taken from the 2019 \n'Equity in Athletics' report") +
scale_fill_manual(values = c("gray50", "red")) +
scale_y_continuous(limits = c(0, 4500000),
labels = dollar) +
coord_flip() +
ggtitle("Total operating cost for Men's varsity teams",
subtitle = "Based on Brown University's 2019 athletic season") +
theme_minimal() +
theme(axis.text.x = element_text(size = 14,
margin = margin(t = 0.5, unit = "cm"),
color = "white"),
axis.text.y = element_text(size = 14,
color = "white"),
axis.title.y = element_blank(),
axis.title.x = element_text(size = 14,
margin = margin(t = 0.5, unit = "cm"),
color = "white"),
plot.title = element_text(size = 16,
face = "bold"),
plot.subtitle = element_text(size = 13,
face = "italic"),
plot.margin = margin(0.5, 0.5, 0.5, r = 0.75, unit = "cm"),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_line(color = "gray22"),
text = element_text(color = "white",
#face = "bold",
family= "Helvetica"),
plot.background = element_rect(fill = "black"),
legend.position = "none")
?label_number_si()
## Plot Cost per athlete for each varsity team (Men)
cost_perAthlete.Men %>%
# Reorder Sport by cost per athlete (reorders the labels on the axis)
mutate(`Varsity Sport` = fct_reorder(`Varsity Sport`, `Operating Costs`)) %>%
# Assemble plot
# Assign fill to Track/XC
ggplot(aes(x = `Varsity Sport`, y = `Operating Costs`, fill = is.track)) +
geom_col(color = "black",
width = 0.75) +
# geom_text(aes(label = label_number_si(`Operating Costs`)),
#           color = "white",
#           size = 4.5,
#           nudge_y = 100000,
#           hjust = 0) +
geom_text(aes(label = label_dollar(`Operating Costs`,
# Divide by 1,000 to report in thousands
scale = 1/1000,
# Round to the tenths place
accuracy = .1,
# Add suffix
suffix = "K")),
color = "white",
size = 4.5,
nudge_y = 100000,
hjust = 0) +
annotate(y = 3000000,
x = "Golf",
geom = "text",
color = "white",
hjust = 0,
vjust = 1,
label = "Data taken from the 2019 \n'Equity in Athletics' report") +
scale_fill_manual(values = c("gray50", "red")) +
scale_y_continuous(limits = c(0, 4500000),
labels = dollar) +
coord_flip() +
ggtitle("Total operating cost for Men's varsity teams",
subtitle = "Based on Brown University's 2019 athletic season") +
theme_minimal() +
theme(axis.text.x = element_text(size = 14,
margin = margin(t = 0.5, unit = "cm"),
color = "white"),
axis.text.y = element_text(size = 14,
color = "white"),
axis.title.y = element_blank(),
axis.title.x = element_text(size = 14,
margin = margin(t = 0.5, unit = "cm"),
color = "white"),
plot.title = element_text(size = 16,
face = "bold"),
plot.subtitle = element_text(size = 13,
face = "italic"),
plot.margin = margin(0.5, 0.5, 0.5, r = 0.75, unit = "cm"),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_line(color = "gray22"),
text = element_text(color = "white",
#face = "bold",
family= "Helvetica"),
plot.background = element_rect(fill = "black"),
legend.position = "none")
## Plot Cost per athlete for each varsity team (Men)
cost_perAthlete.Men %>%
# Reorder Sport by cost per athlete (reorders the labels on the axis)
mutate(`Varsity Sport` = fct_reorder(`Varsity Sport`, `Operating Costs`)) %>%
# Assemble plot
# Assign fill to Track/XC
ggplot(aes(x = `Varsity Sport`, y = `Operating Costs`, fill = is.track)) +
geom_col(color = "black",
width = 0.75) +
# geom_text(aes(label = label_number_si(`Operating Costs`)),
#           color = "white",
#           size = 4.5,
#           nudge_y = 100000,
#           hjust = 0) +
geom_text(aes(label = dollar(`Operating Costs`,
# Divide by 1,000 to report in thousands
scale = 1/1000,
# Round to the tenths place
accuracy = .1,
# Add suffix
suffix = "K")),
color = "white",
size = 4.5,
nudge_y = 100000,
hjust = 0) +
annotate(y = 3000000,
x = "Golf",
geom = "text",
color = "white",
hjust = 0,
vjust = 1,
label = "Data taken from the 2019 \n'Equity in Athletics' report") +
scale_fill_manual(values = c("gray50", "red")) +
scale_y_continuous(limits = c(0, 4500000),
labels = dollar) +
coord_flip() +
ggtitle("Total operating cost for Men's varsity teams",
subtitle = "Based on Brown University's 2019 athletic season") +
theme_minimal() +
theme(axis.text.x = element_text(size = 14,
margin = margin(t = 0.5, unit = "cm"),
color = "white"),
axis.text.y = element_text(size = 14,
color = "white"),
axis.title.y = element_blank(),
axis.title.x = element_text(size = 14,
margin = margin(t = 0.5, unit = "cm"),
color = "white"),
plot.title = element_text(size = 16,
face = "bold"),
plot.subtitle = element_text(size = 13,
face = "italic"),
plot.margin = margin(0.5, 0.5, 0.5, r = 0.75, unit = "cm"),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_line(color = "gray22"),
text = element_text(color = "white",
#face = "bold",
family= "Helvetica"),
plot.background = element_rect(fill = "black"),
legend.position = "none")
## Plot Cost per athlete for each varsity team (Men)
cost_perAthlete.Men %>%
# Reorder Sport by cost per athlete (reorders the labels on the axis)
mutate(`Varsity Sport` = fct_reorder(`Varsity Sport`, `Operating Costs`)) %>%
# Assemble plot
# Assign fill to Track/XC
ggplot(aes(x = `Varsity Sport`, y = `Operating Costs`, fill = is.track)) +
geom_col(color = "black",
width = 0.75) +
geom_text(aes(label = number_si(`Operating Costs`)),
color = "white",
size = 4.5,
nudge_y = 100000,
hjust = 0) +
# geom_text(aes(label = dollar(`Operating Costs`,
#                              # Divide by 1,000 to report in thousands
#                              scale = 1/1000,
#                              # Round to the tenths place
#                              accuracy = .1,
#                              # Add suffix
#                              suffix = "K")),
#           color = "white",
#           size = 4.5,
#           nudge_y = 100000,
#           hjust = 0) +
annotate(y = 3000000,
x = "Golf",
geom = "text",
color = "white",
hjust = 0,
vjust = 1,
label = "Data taken from the 2019 \n'Equity in Athletics' report") +
scale_fill_manual(values = c("gray50", "red")) +
scale_y_continuous(limits = c(0, 4500000),
labels = dollar) +
coord_flip() +
ggtitle("Total operating cost for Men's varsity teams",
subtitle = "Based on Brown University's 2019 athletic season") +
theme_minimal() +
theme(axis.text.x = element_text(size = 14,
margin = margin(t = 0.5, unit = "cm"),
color = "white"),
axis.text.y = element_text(size = 14,
color = "white"),
axis.title.y = element_blank(),
axis.title.x = element_text(size = 14,
margin = margin(t = 0.5, unit = "cm"),
color = "white"),
plot.title = element_text(size = 16,
face = "bold"),
plot.subtitle = element_text(size = 13,
face = "italic"),
plot.margin = margin(0.5, 0.5, 0.5, r = 0.75, unit = "cm"),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_line(color = "gray22"),
text = element_text(color = "white",
#face = "bold",
family= "Helvetica"),
plot.background = element_rect(fill = "black"),
legend.position = "none")
## Plot Cost per athlete for each varsity team (Men)
cost_perAthlete.Men %>%
# Reorder Sport by cost per athlete (reorders the labels on the axis)
mutate(`Varsity Sport` = fct_reorder(`Varsity Sport`, `Operating Costs`)) %>%
# Assemble plot
# Assign fill to Track/XC
ggplot(aes(x = `Varsity Sport`, y = `Operating Costs`, fill = is.track)) +
geom_col(color = "black",
width = 0.75) +
# geom_text(aes(label = label_number_si(`Operating Costs`)),
#           color = "white",
#           size = 4.5,
#           nudge_y = 100000,
#           hjust = 0) +
geom_text(aes(label = dollar(`Operating Costs`,
# Divide by 1,000 to report in thousands
scale = 1/1000,
# Round to the tenths place
accuracy = .1,
# Add suffix
suffix = "K")),
color = "white",
size = 4.5,
nudge_y = 100000,
hjust = 0) +
annotate(y = 3000000,
x = "Golf",
geom = "text",
color = "white",
hjust = 0,
vjust = 1,
label = "Data taken from the 2019 \n'Equity in Athletics' report") +
scale_fill_manual(values = c("gray50", "red")) +
scale_y_continuous(limits = c(0, 4500000),
labels = dollar) +
coord_flip() +
ggtitle("Total operating cost for Men's varsity teams",
subtitle = "Based on Brown University's 2019 athletic season") +
theme_minimal() +
theme(axis.text.x = element_text(size = 14,
margin = margin(t = 0.5, unit = "cm"),
color = "white"),
axis.text.y = element_text(size = 14,
color = "white"),
axis.title.y = element_blank(),
axis.title.x = element_text(size = 14,
margin = margin(t = 0.5, unit = "cm"),
color = "white"),
plot.title = element_text(size = 16,
face = "bold"),
plot.subtitle = element_text(size = 13,
face = "italic"),
plot.margin = margin(0.5, 0.5, 0.5, r = 0.75, unit = "cm"),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_line(color = "gray22"),
text = element_text(color = "white",
#face = "bold",
family= "Helvetica"),
plot.background = element_rect(fill = "black"),
legend.position = "none")
install.packages("scales")
install.packages("scales")
install.packages("scales")
## Key data visualization packages
library(tidyverse)
library(patchwork)
library(scales)
q()
